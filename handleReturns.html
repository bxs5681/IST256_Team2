<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>HiTech Store - Handle Returns</title>

    <!-- Site styles -->
    <link rel="stylesheet" href="Storefront_Page_Layout.css" />

    <!-- Bootstrap -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />

    <!-- jQuery -->
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>

    <!-- Returns scripts -->
    <script src="returnsValidation.js" defer></script>
    <script src="returns.js" defer></script>
</head>
<body>

<header>
    <a href="index.html">
        <img src="Images/HiTech Logo Transparent.png"
             alt="HiTech Store Logo"
             style="height:150px; width:150px; filter:hue-rotate(60deg)" />
    </a>
    <div>
        <h1>HiTech Store</h1>
        <p><em>Your one-stop shop for all tech gadgets</em></p>
    </div>
</header>

<div class="container">
    <nav>
        <ul style="padding-left: 10px;">
            <li><a href="index.html">Home</a></li>
            <li><a href="signup.html">Login</a></li>
            <li><a href="shopper.html">Shopper Management</a></li>
            <li><a href="products.html">Products</a></li>
            <li><a href="shoppingCart.html">Shopping Cart</a></li>
            <li><a href="shippingAndBilling.html">Shipping &amp; Billing</a></li>
            <li><a class="active" href="handleReturns.html">Returns</a></li>
            <li><a href="#">Contact Us</a></li>
        </ul>
    </nav>

    <main>
        <h2>Handle Product Returns</h2>

        <!-- 1. Shopper / Return info -->
        <div class="formSetup">
            <h3 class="form-title">Shopper / Return Information</h3>

            <div class="mb-3">
                <label for="returnEmail" class="form-label"><strong>Shopper Email *</strong></label>
                <input type="email" class="form-control" id="returnEmail" placeholder="name@example.com" />
                <div class="error-message" id="returnEmailError"></div>
            </div>

            <!-- Select a previous order saved by the Shipping & Billing page -->
            <div class="mb-3">
                <label for="previousOrdersSelect" class="form-label"><strong>Select Previous Order (optional)</strong></label>
                <select id="previousOrdersSelect" class="form-select">
                    <option value="">-- Select an order found on this device --</option>
                </select>
                <div class="form-text">We look for orders saved in this browser after checkout.</div>
                <div id="previousOrderHint" class="text-muted mt-1"></div>
            </div>

            <!-- Read-only preview of the selected order's items -->
            <div class="mb-3 d-none" id="selectedOrderItemsWrap">
                <label class="form-label"><strong>Items in Selected Order</strong></label>
                <div id="selectedOrderItems" class="p-2 border rounded" style="background:#f8f9fa;"></div>
            </div>

            <div class="mb-3">
                <label for="orderNumber" class="form-label"><strong>Order Number *</strong></label>
                <input type="text" class="form-control" id="orderNumber" placeholder="Enter order / receipt number" />
                <div class="error-message" id="orderNumberError"></div>
            </div>
        </div>

        <!-- 2. Add products to return -->
        <div class="formSetup">
            <h3 class="form-title">Add Products to Return</h3>

            <div class="mb-3">
                <label for="returnProductSearch" class="form-label"><strong>Search Product (by Product ID)</strong></label>
                <input type="text" class="form-control" id="returnProductSearch" placeholder="e.g. 1 or 2 or 3" />
                <div class="form-text">We will look in local products (from productManagement) or fallback template.</div>
                <div class="error-message" id="returnProductSearchError"></div>
            </div>

            <div class="mb-3">
                <label for="returnReason" class="form-label"><strong>Reason for Return *</strong></label>
                <select id="returnReason" class="form-select">
                    <option value="">-- Select a reason --</option>
                    <option value="Damaged">Item arrived damaged</option>
                    <option value="Wrong Item">Wrong item shipped</option>
                    <option value="Not Needed">No longer needed</option>
                    <option value="Other">Other</option>
                </select>
                <div class="error-message" id="returnReasonError"></div>
            </div>

            <div class="mb-3">
                <label for="returnQty" class="form-label"><strong>Quantity *</strong></label>
                <input type="number" id="returnQty" class="form-control" value="1" min="1" />
                <div class="error-message" id="returnQtyError"></div>
            </div>

            <button id="addReturnItemBtn" class="btn btn-primary">Add to Return List</button>
            <div class="mt-2" id="productLookupMsg"></div>
        </div>

        <!-- 3. Items to be returned -->
        <div class="formSetup">
            <h3 class="form-title">Items to be Returned</h3>
            <table class="table table-bordered" id="returnsTable">
                <thead>
                <tr>
                    <th>Product ID</th>
                    <th>Description</th>
                    <th>Reason</th>
                    <th>Qty</th>
                    <th>Action</th>
                </tr>
                </thead>
                <tbody id="returnsTableBody"></tbody>
            </table>
            <p class="text-muted" id="noReturnsMsg">No return items added yet.</p>
        </div>

        <!-- 4. JSON -->
        <div class="formSetup">
            <h3 class="form-title">Return JSON Document</h3>
            <pre id="returnsJson" style="background:#f8f9fa; padding:12px; border:1px solid #ddd; border-radius:6px;">[]</pre>

            <button id="submitReturnsBtn" class="btn btn-success mt-2">Submit Return (AJAX demo)</button>
            <div id="ajaxMsg" class="mt-2"></div>
        </div>
    </main>

    <aside>
        <div class="formSetup">
            <h3 class="form-title">Returns Help</h3>
            <p>
                Search for the product you purchased, select a reason, and add it to the list.
                You may also select a previous order to auto-populate return details from that order.
                When finished, submit and we will send the JSON to our returns API (demo endpoint).
            </p>
        </div>
    </aside>
</div>

<footer class="site-footer">
    <p>&copy; 2025 HiTech Store</p>
</footer>

</body>
</html>
